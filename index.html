<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Prodigy Clone - Turn System</title>
  <style>
    body { font-family: sans-serif; background: #eef2f7; text-align: center; }
    .screen { display: none; }
    .visible { display: block; }
    button { padding: 10px 20px; margin: 10px; font-size: 16px; }
    .status { font-weight: bold; margin: 10px; }
    .question-box { background: white; padding: 20px; border-radius: 10px; display: inline-block; margin-top: 20px; }
  </style>
</head>
<body>

<!-- HOME SCREEN -->
<div id="homeScreen" class="screen visible">
  <h1>Welcome to Prodigy Clone</h1>
  <button onclick="goToBattle()">Enter Battle</button>
</div>

<!-- BATTLE SCREEN -->
<div id="battleScreen" class="screen">
  <h2>‚öîÔ∏è Battle</h2>
  <div class="status">
    Player HP: <span id="playerHp">100</span> |
    Energy: <span id="playerEnergy">0</span><br>
    Enemy HP: <span id="enemyHp">100</span>
  </div>
  <div id="actions">
    <button onclick="attack()">Attack (10 energy)</button>
    <button onclick="heal()">Heal (10 energy)</button>
    <button onclick="castSpell()">Spell (20 energy)</button>
  </div>
  <p id="battleLog"></p>
</div>

<!-- QUESTION SCREEN -->
<div id="questionScreen" class="screen">
  <h2>üß† Answer Questions to Gain Energy</h2>
  <div class="question-box">
    <p id="questionText"></p>
    <input type="number" id="userAnswer" />
    <p id="feedback"></p>
    <button onclick="submitAnswer()">Submit Answer</button>
  </div>
</div>

<script>
  let playerHp = 100;
  let playerEnergy = 0;
  let enemyHp = 100;

  // QUESTION SYSTEM
  let questionCount = 0;
  let correctAnswers = 0;
  let currentAnswer = 0;

  function switchScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('visible'));
    document.getElementById(screenId).classList.add('visible');
  }

  function goToBattle() {
    resetBattle();
    startQuestionPhase();
  }

  function resetBattle() {
    playerHp = 100;
    playerEnergy = 0;
    enemyHp = 100;
    updateUI();
    log('');
  }

  function updateUI() {
    document.getElementById("playerHp").innerText = playerHp;
    document.getElementById("enemyHp").innerText = enemyHp;
    document.getElementById("playerEnergy").innerText = playerEnergy;
  }

  function log(msg) {
    document.getElementById("battleLog").innerText = msg;
  }

  // === QUESTIONS ===
  function startQuestionPhase() {
    correctAnswers = 0;
    questionCount = 0;
    switchScreen("questionScreen");
    nextQuestion();
  }

  function nextQuestion() {
    const a = Math.floor(Math.random() * 10) + 1;
    const b = Math.floor(Math.random() * 10) + 1;
    currentAnswer = a + b;
    document.getElementById("questionText").innerText = `What is ${a} + ${b}?`;
    document.getElementById("userAnswer").value = '';
    document.getElementById("feedback").innerText = '';
  }

  function submitAnswer() {
    const input = document.getElementById("userAnswer").value.trim();
    if (input === '') {
      alert("Please enter an answer before continuing.");
      return;
    }

    const user = parseInt(input);
    const feedback = document.getElementById("feedback");

    if (user === currentAnswer) {
      correctAnswers++;
      feedback.innerText = "‚úÖ Correct!";
    } else {
      feedback.innerText = `‚ùå Incorrect. The correct answer was ${currentAnswer}.`;
    }

    questionCount++;
    if (questionCount < 3) {
      setTimeout(nextQuestion, 1500);
    } else {
      setTimeout(() => {
        const energyGained = correctAnswers * 10;
        playerEnergy += energyGained;
        updateUI();
        log(`You got ${correctAnswers}/3 correct and gained ${energyGained} energy.`);
        switchScreen("battleScreen");
      }, 2000);
    }
  }

  // === ACTIONS ===
  function attack() {
    if (playerEnergy < 10) return log("‚ùå Not enough energy!");
    enemyHp -= 20;
    playerEnergy -= 10;
    log("You attacked the enemy for 20!");
    endTurn();
  }

  function heal() {
    if (playerEnergy < 10) return log("‚ùå Not enough energy!");
    playerHp = Math.min(100, playerHp + 15);
    playerEnergy -= 10;
    log("You healed for 15 HP.");
    endTurn();
  }

  function castSpell() {
    if (playerEnergy < 20) return log("‚ùå Not enough energy!");
    enemyHp -= 35;
    playerEnergy -= 20;
    log("You cast a spell for 35 damage!");
    endTurn();
  }

  function endTurn() {
    updateUI();
    if (enemyHp <= 0) {
      alert("You win! üéâ");
      switchScreen("homeScreen");
    } else if (playerHp <= 0) {
      alert("You were defeated! üíÄ");
      switchScreen("homeScreen");
    } else if (playerEnergy <= 0) {
      const dmg = Math.floor(Math.random() * 15) + 10;
      playerHp -= dmg;
      updateUI();
      log(`Enemy attacked for ${dmg} while you had no energy!`);
      if (playerHp <= 0) {
        alert("You were defeated! üíÄ");
        switchScreen("homeScreen");
      } else {
        setTimeout(startQuestionPhase, 1000);
      }
    }
  }
</script>

</body>
</html>
